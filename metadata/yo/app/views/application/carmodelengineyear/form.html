<form name="cmeyForm" novalidate data-reference-form-controller authorize="ROLE_APPLICATION_CRUD">

  <div class="row">
    <div class="col-xs-6">
      <h2>{{::titleHead}} Car Model Engine Year <span data-ng-show="cmey.id">#{{cmey.id}}</span></h2>
    </div>
    <div class="col-xs-6 vcenter">
      <div id="cmey-frm-error" class="alert alert-danger" data-ng-show="cmeyForm.$dirty && cmeyForm.$error.nonUniqueApp">
        <i class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></i>
        Application with these attributes already exists.
      </div>
    </div>
  </div>

  <div class="row" data-ng-show="pickedModels.length > 0 || pickedEngines.length > 0 || pickedYears.length > 0" style="min-height:15em;">
    <div class="col-xs-12 col-md-4">
      <div>
        <button id="bttn-cmey-frm-unpickallmodels" type="button" title="Unpick all" class="btn btn-link btn-sm btn-h4" data-ng-click="unpickAllCarModels()" data-ng-show="pickedModels.length">
          <i class="fa fa-times"></i>
        </button>
        <h4 class="text-nowrap pull-left">Picked Make/Models</h4>
      </div>
      <table id="cmey-frm-tbl-pickedmodels" data-ng-table="pickedModelsTableParams" class="table table-bordered table-striped table-hover table-responsive">
      <tr data-ng-repeat="rec in $data">
        <td title="'Make'">{{rec.make.name}}</td>
        <td title="'Model'">{{rec.name}}</td>
        <td class="actions text-center" title="'Actions'">
          <button type="button" class="btn btn-danger btn-xs" data-ng-click="unpickCarModel(rec.id)">
            <i class="fa fa-times"></i>
            Unpick
          </button>
        </td>
      </tr>
      <tr data-ng-hide="$data.length > 0">
        <td colspan="3">No data.</td>
      </tr>
      </table>
    </div>
    <div class="col-xs-12 col-md-3">
      <div>
        <button id="bttn-cmey-frm-unpickallengines" type="button" title="Unpick all" class="btn btn-link btn-sm btn-h4" data-ng-click="unpickAllCarEngines()" data-ng-show="pickedEngines.length">
          <i class="fa fa-times"></i>
        </button>
        <h4 class="text-nowrap pull-left">Picked Engines</h4>
      </div>
      <table id="cmey-frm-tbl-pickedengines" data-ng-table="pickedEnginesTableParams" class="table table-bordered table-striped table-hover table-responsive">
      <tr data-ng-repeat="rec in $data">
        <td title="'Engine'">{{rec.name}}</td>
        <td class="actions text-center" title="'Actions'">
          <button type="button" class="btn btn-danger btn-xs" data-ng-click="unpickCarEngine(rec.id)">
            <i class="fa fa-times"></i>
            Unpick
          </button>
        </td>
      </tr>
      <tr data-ng-hide="$data.length > 0">
        <td colspan="2">No data.</td>
      </tr>
      </table>
    </div>
    <div class="col-xs-12 col-md-3">
      <div>
        <button id="bttn-cmey-frm-unpickallyears" type="button" title="Unpick all" class="btn btn-link btn-sm btn-h4" data-ng-click="unpickAllCarYears()" data-ng-show="pickedYears.length">
          <i class="fa fa-times"></i>
        </button>
        <h4 class="text-nowrap pull-left">Picked Years</h4>
      </div>
      <table id="cmey-frm-tbl-pickedyears" data-ng-table="pickedYearsTableParams" class="table table-bordered table-striped table-hover table-responsive">
      <tr data-ng-repeat="rec in $data">
        <td title="'Year'">{{rec.name}}</td>
        <td class="actions text-center" title="'Actions'">
          <button type="button" class="btn btn-danger btn-xs" data-ng-click="unpickCarYear(rec.name)">
            <i class="fa fa-times"></i>
            Unpick
          </button>
        </td>
      </tr>
      <tr data-ng-hide="$data.length > 0">
        <td colspan="2">No data.</td>
      </tr>
      </table>
    </div>
    <div class="col-xs-12 col-md-2">
      <button id="bttn-cmey-frm-doit" type="button" data-ng-click="bulkGeneration()" class="btn btn-success btn-lg pull-right">
        <i class="fa fa-wrench"></i>
        Do it!
      </button>
    </div>
  </div>

  <hr data-ng-show="pickedModels.length > 0 || pickedEngines.length > 0 || pickedYears.length > 0" style="padding-bottom:1em;" />

  <div class="row">

    <div class="col-xs-12 col-md-6">
      <div class="form-group">
        <div>
          <label for="carmakeFilter">
            Car Make
            <button id="bttn-cmey-frm-make-clear" type="button" title="Clear" data-ng-click="onClearMM()" data-ng-disabled="cmey.model.make.id == null && filters.carMake === ''" class="btn btn-link btn-sm">
              <i class="fa fa-times"></i>
            </button>
          </label>
          <div class="pull-right">
            <button id="bttn-cmey-frm-make-quickcreate" type="button" class="btn btn-success btn-sm" data-ng-click="quickCreateCarMake()">
              <i class="fa fa-wrench"></i>
              Quick Create
            </button>
          </div>
        </div>
        <input id="carmakeFilter" data-ng-model="filters.carMake" class="form-control" placeholder="Car make filter..."/>
        <select id="inpt-cmey-frm-carmake" name = "car_make" data-ng-model="cmey.model.make.id" data-ng-change="onChangeMake()"
          data-ng-options="carmake.id as carmake.name for carmake in carmakes | filter:{name:filters.carMake}"
          data-ng-disabled="carmakes.length == 0"
          size="6" class="select-large form-control">
        </select>
      </div>
    </div>

    <div class="col-xs-12 col-md-6">
      <div class="form-group">
        <div>
          <label for="carmodelFilter">
            Car Model
            <button id="bttn-cmey-frm-model-clear" type="button" title="Clear" data-ng-click="onClearMM()" class="btn btn-link btn-sm" data-ng-disabled="cmey.model.id == null && filters.carModel === ''">
              <i class="fa fa-times"></i>
            </button>
          </label>
          <div class="btn-toolbar pull-right">
            <button id="bttn-cmey-frm-model-quickcreate" type="button" class="btn btn-success btn-sm" data-ng-click="quickCreateCarModel()">
              <i class="fa fa-wrench"></i>
              Quick Create
            </button>
            <button id="bttn-cmey-frm-model-pick" type="button" data-ng-disabled="cmey.model.id == null || pickedModelIds[cmey.model.id] || cmey.model.make.id == null" class="btn btn-success btn-sm" data-ng-click="pickCarModel()">
              <i class="fa fa-bullseye"></i>
              Pick
            </button>
          </div>
        </div>
        <input id="carmodelFilter" data-ng-model="filters.carModel" class="form-control" placeholder="Car model filter..."/>
        <select id="inpt-cmey-frm-carmodel"
          name = "car_model"
          data-ng-model="cmey.model.id"
          data-ng-dblclick="pickCarModel()"
          data-ng-options="carmodel.id as carmodel.name for carmodel in carmodels | filter:{name:filters.carModel}"
          data-ng-disabled="carmodels.length == 0"
          size="6" class="select-large form-control">
        </select>
      </div>
    </div>

  </div>

  <div class="row">
    <div class="col-xs-12 col-md-6">
      <div class="form-group">
        <div>
          <label class="control-label" for="car_engine">
            Car Engine
            <button id="bttn-cmey-frm-engine-clear" title="Clear" data-ng-click="onClearEngine()" data-ng-disabled="cmey.engine.id == null && filters.carEngine === ''" class="btn btn-link btn-sm">
              <i class="fa fa-times"></i>
            </button>
          </label>
          <div class="btn-toolbar pull-right">
            <button id="bttn-cmey-frm-engine-quickcreate" type="button" class="btn btn-success btn-sm" data-ng-click="quickCreateCarEngine()">
              <i class="fa fa-wrench"></i>
              Quick Create
            </button>
            <button id="bttn-cmey-frm-engine-pick" type="button" data-ng-disabled="cmey.engine.id == null || pickedEngineIds[cmey.engine.id]" class="btn btn-success btn-sm" data-ng-click="pickCarEngine()">
              <i class="fa fa-bullseye"></i>
              Pick
            </button>
          </div>
        </div>
        <input id="carengineFilter" data-ng-model="filters.carEngine" class="form-control" placeholder="Car engine filter..."/>
        <select id="car_engine"
                data-ng-model="cmey.engine.id" class="form-control"
                data-ng-dblclick="pickCarEngine()"
                data-ng-options="item.id as item.name for item in carengines | orderBy:'name' | filter:{name:filters.carEngine}"
                data-ng-disabled="carengines == null || carengines.length == 0"
                size="6" class="form-control input-sm">
        </select>
      </div>
    </div>

    <div class="col-xs-12 col-md-6">
      <div class="form-group">
        <div>
          <label class="control-label" for="car_year">
            Car Year
            <button id="bttn-cmey-frm-year-clear" title="Clear" data-ng-click="onClearYear()" data-ng-disabled="cmey.year.name == null" class="btn btn-link btn-sm">
              <i class="fa fa-times"></i>
            </button>
          </label>
          <div class="btn-toolbar pull-right">
            <button id="bttn-cmey-frm-year-pick" type="button"
                    data-ng-disabled="cmey.year.name == null || pickedYearNames[cmey.year.name] || cmeyForm.car_year.$invalid"
                    class="btn btn-success btn-sm" data-ng-click="pickCarYear()">
              <i class="fa fa-bullseye"></i>
              Pick
            </button>
          </div>
        </div>
        <input id="car_year" type="number" name="car_year" class="form-control input-sm"
               data-ng-model="cmey.year.name"
               data-ng-model-options="{ debounce: 500 }"
               data-ng-maxlength="4"
               data-ng-min="1900"
               data-ng-pattern="/^[0-9]*$/"
               data-ng-change="onChangeYear()" maxlength="255">
        <span data-ng-show="cmeyForm.car_year.$viewValue != '' && cmeyForm.car_year.$dirty && cmeyForm.car_year.$valid && !carYearExists" class="alert alert-warning" role="alert">
          <span class="glyphicon glyphicon-warning-sign" aria-hidden="true"></span>
          <span>This year is not existing and will be added automatically.</span>
        </span>
        <span data-ng-show="cmeyForm.car_year.$dirty && cmeyForm.car_year.$invalid" class="alert alert-danger" role="alert">
          <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
          <span data-ng-show="cmeyForm.car_year.$error.min || cmeyForm.car_year.$error.pattern || cmeyForm.car_year.$error.maxlength">Invalid year!</span>
        </span>
      </div>
    </div>
  </div>

</form>
