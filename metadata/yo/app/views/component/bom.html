<div class="pull-right" style="margin-bottom: 5px;">
  <a authorize="ROLE_BOM"
     class="btn btn-primary"
     data-ng-href="/part/{{parentPartId}}/parentbom/search">
    <i class="fa fa-plus"></i> Add to Parent
  </a>
  <a authorize="ROLE_BOM"
     class="btn btn-primary"
     data-ng-href="/part/{{parentPartId}}/bom/search">
    <i class="fa fa-plus"></i> Add Child
  </a>
</div>

<table data-ng-table="bomTableParams" class="table table-bordered table-striped table-hover table-responsive">
  <tr data-ng-repeat="b in $data" data-ng-class="{selected: b === selectedBom}">
    <td title="'Part#'" class="text-center text-nowrap" data-sortable="'partNumber'">
      <a data-ng-href="/part/{{b.partId}}">{{b.partNumber}}</a>
    </td>
    <td title="'Qty'" class="text-right" data-sortable="'qty'">
      <span data-ng-hide="isModifying(b)">{{b.qty}}</span>
      <input data-ng-model="modifyValues[b.partId]" type="text" data-ng-show="isModifying(b)"/>
    </td>
    <td title="'Type'" data-sortable="'partType.name'">
      {{b.partType.name}}
    </td>
    <td title="'Name'" data-sortable="'child.name'">
      {{b.name}}
    </td>
    <td title="'Interchange'">
      <ul class="list-unstyled list-inline" style="margin-bottom:0">
      <li data-ng-repeat="row in b.interchanges">
        <a data-ng-href="/part/{{row.partId}}">{{row.partNumber}}</a><span data-ng-if="!$last">,</span>
      </li>
      </ul>
    </td>
    <td title="'Actions'" class="actions">

      <button data-ng-click="modifyStart(b)"
              authorize="ROLE_BOM" class="btn btn-warning btn-xs"
              data-ng-hide="isModifying(b)">
        <i class="fa fa-cog"></i> Modify
      </button>

      <button data-ng-click="modifySave(b)"
              authorize="ROLE_BOM" class="btn btn-success btn-xs"
              data-ng-show="isModifying(b)">
        <i class="fa fa-save"></i> Save
      </button>

      <button data-ng-click="modifyCancel(b)"
              authorize="ROLE_BOM" class="btn btn-warning btn-xs"
              data-ng-show="isModifying(b)">
        <i class="fa fa-minus-circle"></i> Cancel
      </button>

      <button data-ng-click="showAlternates(b)"
         authorize="ROLE_READ" class="btn btn-info btn-xs"
         data-ng-hide="isModifying(b)" data-ng-disabled="b === selectedBom">
        <i class="fa fa-random"></i> Alternates
      </button>

      <button data-ng-click="remove(b)"
              authorize="ROLE_BOM" class="btn btn-danger btn-xs"
              data-ng-hide="isModifying(b)">
        <i class="fa fa-trash-o"></i> Remove
      </button>

    </td>
  </tr>

  <tr data-ng-hide="$data.length > 0">
    <td colspan="6">No parts to display.</td>
  </tr>
</table>

<div class="row" data-ng-show="selectedBom">
  <div class="col-xs-12">

    <div class="row" style="margin-top:35px">
      <div class="col-xs-12">
        <div class="pull-right">
          <button class="btn btn-warning" data-ng-click="newAltGroup()">
            <i class="fa fa-plus"></i>
            New Group
          </button>
        </div>
        <div class="pull-left">
          <h4 part-name="selectedBom" part-name-suffix="Alternates" class="selected" style="display:inline-block;padding:4px 5px;"></h4>
        </div>
      </div>
    </div>
    
    <pre>{{altBoms | json:2}}</pre>

    <p data-ng-show="!altBoms || altBoms.length === 0">
      There are no any Alternative BOM group(s). Use button "New Group" to add a new one.
    </p>

    <ul class="list-unstyled" data-ng-hide="!altBoms || altBoms.length === 0">
    <li data-ng-repeat="g in altBoms">
      <hr>
      <div class="row" style="margin-bottom: 5px;">
        <div class="col-xs-12">
          <div class="pull-right">
            <button class="btn btn-danger btn-sm" authorize="ROLE_BOM_ALT" data-ng-click="removeAltGroup(g.altHeaderId)">
              <i class="fa fa-trash-o"></i>
              Delete Group
            </button>
            <button class="btn btn-info btn-sm" authorize="ROLE_BOM_ALT" data-ng-click="openAddAlternativeView(g.altHeaderId)">
              <i class="fa fa-plus"></i>
              Add Alternate
            </button>
          </div>
          <div class="pull-left">
            <h5 style="display:inline-block">Group: [{{g.altHeaderId}}]</h5>
          </div>
        </div>
      </div>

      <table data-ng-table="g.ngTableParams" class="table table-bordered table-striped table-hover table-responsive">
      <tr data-ng-repeat="ab in $data">
        <td title="'Part Type'" data-sortable="'partType.name'">{{ab.partType.name}}</td>
        <td title="'Manufacturer'" data-sortable="'manufacturer.name'">{{ab.manufacturer.name}}</td>
        <td title="'Part#'" class="text-nowrap" data-sortable="'partNumber'">
          <a data-ng-href="/part/{{ab.partId}}">{{ab.partNumber}}</a>
        </td>
        <td title="'Actions'" class="actions">
          <button data-ng-click="removeAlternate(g.altHeaderId, ab.partId)" authorize="ROLE_BOM_ALT" class="btn btn-danger btn-xs">
            <i class="fa fa-trash-o"></i> Remove
          </button>
        </td>
      </tr>
      <tr data-ng-hide="$data.length > 0">
        <td colspan="4">No parts to display.</td>
      </tr>
      </table>

    </li>
    </ul>

  </div>
</div>
