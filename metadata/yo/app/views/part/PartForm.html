<metanav>
  <li authorize="ROLE_READ">
    <a data-ng-href="/part/{{ partId }}"
       class="btn btn-primary" data-ng-hide="oldPart == null">
      <i class="fa fa-eye"></i>
      View Part
    </a>
  </li>
  <li authorize="ROLE_ALTER_PART">
    <button type="button" data-ng-disabled="partForm.$pristine || partForm.$invalid || partForm.$pending"
            data-ng-click="save()" class="btn btn-success">
      <i class="fa fa-save"></i>
      Save
    </button>
  </li>
  <li>
    <button type="button" data-ng-click="revert()"
            data-ng-disabled="partForm.$pristine"
            class="btn btn-warning"
            data-ng-hide="oldPart == null">
      <i class="fa fa-undo"></i>
      Revert
    </button>
  </li>
</metanav>

<div class="row">
  <div class="col-xs-4">
    <h2>
      <span data-ng-hide="partId">Create </span>
      <span data-ng-show="partId">Edit </span>
      {{ part.partType.name }}
      <span data-ng-show="partId">#{{ partId }} </span>
    </h2>
  </div>
  <div class="col-xs-2">
    <div class="pull-right" style="margin-top:20px;margin-bottom:10px;">
      <label>Status</label>
      <button data-ng-model="part.inactive" class="btn btn-sm btn-info" btn-checkbox>
        <span data-ng-show="part.inactive">
          <i class="fa fa-warning"></i> Inactive
        </span>
        <span data-ng-hide="part.inactive">
          <i class="fa fa-info-circle"></i> Active
        </span>
      </button>
    </div>
  </div>
  <div class="col-xs-6"></div>
</div>

<form name="partForm">
  <div class="row">
    <div class="col-xs-6">

      <div class="form-group">
        <label for="name">Name</label>
        <input id="name" class="form-control" type="text" data-ng-model="part.name"/>
      </div>

      <div class="form-group">
        <label for="description">Description</label>
        <textarea id="description" class="form-control" rows="4" data-ng-model="part.description"></textarea>
      </div>

      <div class="form-group">
        <label for="manufacturer">Manufacturer</label>
        <select id="manufacturer" class="form-control" data-ng-model="part.manufacturer" data-ng-options="mn as mn.name for mn in manufacturers track by mn.id" required>
        </select>
        <div data-ng-show="partForm.manufacturer.$invalid" class="alert alert-danger" role="alert">
          <span data-ng-show="partForm.manufacturer.$error.required">Required!</span>
          <span data-ng-show="partForm.manufacturer.$error.nonUniquePartNumber">Pair (Manufacturer, P/N) is not unique!</span>
        </div>
      </div>

      <div class="form-group">
        <label>Manufacturer P/N</label>
        <ul class="list-unstyled">
          <li data-ng-repeat="mpn in mpns">
            <div class="input-group" style="margin-bottom:4px;">
              <input id="{{mpn.id}}" name="{{mpn.id}}" class="form-control" type="text" data-ng-model="mpn.val" data-ng-model-options="{ debounce: 500 }" required maxlength="255" unique-part-number />
              <span class="input-group-btn">
                <button type="button" class="btn btn-danger" data-ng-disabled="$first" data-ng-click="delPn($index)" title="Delete row">
                  <i class="fa fa-minus" aria-hidden="true"></i>
                </button>
              </span>
            </div>
            <div data-ng-show="partForm[mpn.id].$dirty && partForm[mpn.id].$invalid" class="alert alert-danger" role="alert">
              <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
              <span data-ng-show="partForm[mpn.id].$error.required">Required!</span>
              <span data-ng-show="partForm[mpn.id].$error.maxlenth">Too long manufacturer part number (max 255 chars)!</span>
              <span data-ng-show="partForm[mpn.id].$error.nonUniquePartNumber">Pair (Manufacturer, P/N) is not unique!</span>
            </div>
          </li>
        </ul>
        <button type="button" class="btn btn-primary btn-xs pull-right" data-ng-click="addPn()" data-ng-disabled="partForm.$invalid" data-ng-hide="part.id">
          <i class="fa fa-plus" aria-hidden="true"></i>
          Add P/N
        </button>
      </div>

      <!-- Type-specific fields -->
      <div data-ng-switch="part.partType.magentoAttributeSet">

        <!-- Kit -->
        <div data-ng-switch-when="Kit" class="form-group">
          <label>Kit Type</label>
          <picker id="picker_kittype" item-type="type/kittype" data-ng-model="part.kitType"></picker>
        </div>

        <!-- Turbo -->
        <div data-ng-switch-when="Turbo" class="form-group">
          <label>Coolant</label>
          <picker item-type="type/cooltype" data-ng-model="part.coolType"></picker>
        </div>
        <div data-ng-switch-when="Turbo">
          <h3>Turbo Model</h3>
          <div data-ng-include="'/views/part/form/TurboModel.html'"></div>
        </div>

      </div>

    </div>

  </div>

</form>
