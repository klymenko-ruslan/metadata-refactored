server {
	server_name metadata.turbointernational.com;
	rewrite ^ https://$server_name$request_uri? permanent;
}



# HTTPS server
#
server {
	listen 443;
	server_name metadata.turbointernational.com;

	# Uploads (for images)
	client_max_body_size 10M;


	root html;
	index index.html index.htm;

	ssl on;
	ssl_certificate metadata.crt;
	ssl_certificate_key metadata.key;

	ssl_session_timeout 5m;

	ssl_protocols SSLv3 TLSv1;
	ssl_ciphers ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv3:+EXP;
	ssl_prefer_server_ciphers on;

	location / {
		proxy_pass 		http://localhost:8080;
		proxy_redirect		http://$server_name https://$server_name;
		proxy_set_header        X-Real-IP $remote_addr;
		proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header        Host $http_host;
	}

	location /search {
		proxy_pass 		http://localhost:9300;
		proxy_pass_header       Access-Control-Allow-Methods;
		proxy_pass_header       Access-Control-Allow-Origin;
		proxy_pass_header       Date;
		proxy_set_header        X-Real-IP $remote_addr;
		proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header        Host $http_host;
	}
}

